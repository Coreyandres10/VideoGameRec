<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>User Profile</title>

    <link
    href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.16/dist/tailwind.min.css"
    rel="stylesheet"
  />
  </head>
  <body>
    <nav class="bg-white border-gray-200 py-2.5 dark:bg-gray-900">
        <div
          class="flex flex-wrap items-center justify-between max-w-screen-xl px-4 mx-auto"
        >
          <a href="/" class="flex items-center">
            <img
              src="https://upload.wikimedia.org/wikipedia/commons/e/ed/Xbox-360-S-Controller.png"
              class="h-6 mr-3 sm:h-9"
              alt="Logo"
            />
            <span class="font-semibold text-xl tracking-tight"></span>
              Recommendation</span
            >
          </a>
          <div class="flex items-center">
            <div class="hidden mt-2 mr-4 sm:inline-block">
              <span></span>
            </div>
  
            <button
              data-collapse-toggle="mobile-menu-2"
              type="button"
              class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600"
              aria-controls="mobile-menu-2"
              aria-expanded="true"
            >
              <span class="sr-only">Open main menu</span>
              <svg
                class="w-6 h-6"
                fill="currentColor"
                viewBox="0 0 20 20"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  fill-rule="evenodd"
                  d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"
                  clip-rule="evenodd"
                ></path>
              </svg>
              <svg
                class="hidden w-6 h-6"
                fill="currentColor"
                viewBox="0 0 20 20"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  fill-rule="evenodd"
                  d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
                  clip-rule="evenodd"
                ></path>
              </svg>
            </button>
          </div>
          <div
            class="items-center justify-between w-full lg:flex lg:w-auto lg:order-1"
            id="mobile-menu-2"
          >
            <ul
              class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"
            >
              <li>
                <a
                  href="/"
                  class="block py-2 pl-3 pr-4 text-white bg-purple-700 rounded lg:bg-transparent lg:text-purple-700 lg:p-0 dark:text-white"
                  aria-current="page"
                  >Home</a
                >
              </li>
              <li>
                <a
                  href="/login"
                  class="block py-2 pl-3 pr-4 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-purple-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700"
                  >Login</a
                >
              </li>

              <li>
                <a
                  href="/profile"
                  class="block py-2 pl-3 pr-4 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-purple-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700"
                  >Profile</a
                >
              </li>
            </ul>
          </div>
        </div>
      </nav>



      <!-- views/profile.ejs -->
<div class="container max-w-screen-xl  mx-auto mt-8">
    <div class="flex justify-between items-center mb-4">
        <div class="flex items-center">
            <img src="https://cdn-icons-png.flaticon.com/512/666/666201.png" alt="Image" class="w-16 h-16 mr-4">
            <h1 class="text-3xl font-bold">Account Information</h1>
        </div>
        <nav aria-label="breadcrumb" class="text-sm">
            <ol class="list-none p-0 inline-flex">
                <li class="flex items-center">
                    <a href="/" class="text-gray-500">Home</a>
                </li>
                <li class="flex items-center">
                    <span class="mx-2 text-gray-500">/</span>
                </li>
                <li class="flex items-center text-gray-700" aria-current="page">
                    Account Information
                </li>
            </ol>
        </nav>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 mt-10 ">
        <!-- Name Card -->
        <div class="card-box-c foo">
            <div class="card-header-c mb-5 d-flex">
                <div class="card-box-ico"></div>
                <div class="card-title-c align-self-center">
                    <h2 class="text-xl font-bold">Name</h2>
                </div>
            </div>
            <div class="card-body-c">
                <p class="h5 content-c">
                    <%= user.name %>
                </p>
            </div>
        </div>

        <!-- Email Card -->
        <div class="card-box-c foo">
            <div class="card-header-c mb-5 d-flex">
                <div class="card-box-ico"></div>
                <div class="card-title-c align-self-center">
                    <h2 class="text-xl font-bold">Email Address</h2>
                </div>
            </div>
            <div class="card-body-c">
                <p class="h5 content-c">
                    <%= user.email %>
                </p>
            </div>
        </div>

        <div class="card-box-c foo">
            <div class="card-header-c mb-5 d-flex">
                <div class="card-box-ico"></div>
                <div class="card-title-c align-self-center">
                    <h2 class="text-xl font-bold">Action</h2>
                </div>
            </div>
            <div class="h5 card-body-c">
                <p class="content-c">
                    <!-- Edit Icon - Trigger Modal -->
                    <span class="mr-2 cursor-pointer bg bg-green-400 p-2 rounded " onclick="openEditModal()">Edit</span>
                    <span class="cursor-pointer bg-red-400 p-2 rounded" onclick="deleteUser()">Delete</span>
                </p>
            </div>
        </div>
    </div>
</div>






<div id="editModal" class="fixed top-0 left-0 w-full h-full bg-black bg-opacity-50 hidden">
    <div class="modal-content mx-auto my-16 bg-white p-8 rounded-lg">
        <h2 class="text-2xl font-bold mb-4">Edit User Information</h2>
        <form id="editForm">
            <!-- Display Current User Info -->
            <div class="mb-4">
           <h1>Make the changes as you want</h1>
            </div>

            <!-- Editable Fields -->
            <div class="mb-4">
                <label for="name" class="block text-sm font-medium text-gray-700">Name:</label>
                <input type="text" value="<%= user.name %>" id="name" name="name" class="w-full border rounded p-2">
            </div>
            <div class="mb-4">
                <label for="email" class="block text-sm font-medium text-gray-700">Email:</label>
                <input type="email" id="email" value="<%= user.email %>" name="email" class="w-full border rounded p-2">
            </div>
            <!-- <div class="mb-4">
                <label for="password" class="block text-sm font-medium text-gray-700">Password:</label>
                <input type="password" id="password" placeholder="****" name="password" class="w-full border rounded p-2">
            </div> -->

            <!-- Submit Button -->
           <!-- Updated Submit Button -->
<button type="button" onclick="submitEditForm()" class="bg-blue-500 text-white rounded p-2">Submit</button>

        </form>

        <!-- Close Modal Button -->
        <button onclick="closeEditModal()" class="absolute top-0 right-0 p-4 cursor-pointer">&times;</button>
    </div>
</div>


<script>
    function openEditModal() {
        document.getElementById('editModal').style.display = 'block';
    }

    function closeEditModal() {
        document.getElementById('editModal').style.display = 'none';
    }

    async function submitEditForm() {
        const userId = '<%= user._id %>'; // Add the user ID here
        const newName = document.getElementById('name').value;
        const newEmail = document.getElementById('email').value;
        // const newPassword = document.getElementById('password').value;
        console.log(userId,newName,newEmail);

        try {
            const response = await fetch(`http://localhost:3000/api/update-user/${userId}`, {
                method: 'POST',
                headers: {
                'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    name: newName,
                    email: newEmail,
                }),
            });
            if (response.ok) {
              window.location.href="/profile"
            } else {
                console.error('Failed to update user information');
            }
        } catch (error) {
            console.error('An error occurred while updating user information', error);
        }
        closeEditModal();
    }



const deleteUser = async()=>{
    let id='<%= user._id%>';
   console.log(id);
    
 
    try {
            const response = await fetch(`http://localhost:3000/api/delete-user/${id}`, {
                method: 'DELETE',
            });
        
              alert('User deleted successfully')
            window.location.href="/login"
            if (response.ok) {
                console.log('User deleted successfully' );
             
            } else {
                console.error('Failed to deleting user information');
            }
        } catch (error) {
            console.error('An error occurred while deleting user information', error);
        }

    };


</script>


  <script src="https://unpkg.com/flowbite@1.4.1/dist/flowbite.js"></script>
</body>
</html>
